# 공유 자원(Shared Resource)이란?

공유 자원은 시스템 안에서 각 프로세스, 스레드가 함께 접근할 수 있는 모니터, 프린터, 메모리, 파일, 데이터 등의 자원이나 변수 등을 말합니다. 공유 자원은 공동으로 이용되기 때문에 두 개 이상의 프로세스가 동시에 읽거나 쓰는 상황이 발생합니다. 이런 상황을 경쟁 상태(race condition)이라 합니다.

# 임계 영역(Critical Section)이란?

임계 영역은 공유 자원 접근 순서에 따라 실행 결과가 달라지는 프로그램의 영역을 말합니다. 그렇기 때문에 임계 구역에서는 프로세스들이 동시에 작업을 하면 안됩니다. 

## 임계 영역 해결 조건

- 상호 배제(Mutual Exclusion): 한 프로세스가 임계 영역에 들어가면 다른 프로세스는 임계 영역에 들어갈 수 없습니다.

- 한정 대기(Bounded Wating): 어떤 프로세스도 영원히 임계 영역에 들어가지 못하면 안됩니다.

- 진행의 융통성(Progress Flexibility): 한 프로세스가 다른 프로세스의 일을 방해해서는 안됩니다.

# 임계 영역 해결 방법

임계 영역을 해결하는 방법으로는 크게 뮤텍스, 세마포어, 모니터 세 가지가 있습니다. 이 방법 모두 임계 영역 해결 조건들을 만족합니다.

## 뮤텍스(Mutex)

- 뮤텍스는 임계 영역을 가진 스레드들의 실행 시간이 서로 겹치지 않고 각각 단독으로 실행(상호 배제) 되도록 하는 기술입니다. 

- 공유 자원을 사용하기 전에 잠금을 설정하면 다른 스레드는 잠긴 코드 영역에 접근할 수 없습니다. 다 사용한 후에는 잠금 해제(Unlock)를 통해 다른 스레드가 접근 가능하게 됩니다.

- 뮤텍스는 잠금 또는 잠금 해제 중에 한 가지 상태만을 가집니다.

## 세마포어(Semaphore)

- 공유 자원에 접근할 수 있는 프로세스의 최대 허용치 만큼 동시에 사용자가 접근할 수 있습니다.

- 세마포어에는 조건 변수가 없고 프로세스가 세마포어 값을 수정할 때 다른 프로세스는 동시에 세마포어 값을 수정할 수 없습니다.

- 각 프로세스는 세마포어의 값을 확인하고 변경할 수 있습니다. 자원이 사용하지 않는 상태가 되면 대기하던 프로세스가 즉시 자원을 사용합니다. 하지만 이미 다른 프로세스에 의해 사용중이라는 사실을 알게 되면, 재시도 하기 전에 일정시간 대기해야 합니다.

## 모니터(Monitor)

- 모니터는 둘 이상의 스레드나 프로세스가 공유 자원에 안전하게 접근할 수 있도록 공유 자원을 숨기고 해당 접근에 대해 인터페이스만 제공합니다.

- 모니터는 모니터큐를 통해 공유 자원에 대한 작업들을 순차적으로 처리합니다.


# 뮤텍스와 세마포어의 차이점

가장 큰 차이점은 동기화 대상의 개수입니다.

- 뮤텍스는 동기화 대상이 1개일 때 사용합니다.

- 세마포어는 동기화 대상이 1개 이상일 때 사용합니다.

세마포어는 뮤텍스가 될 수 있지만, 뮤텍스는 세마포어가 될 수 없습니다.

- 뮤텍스는 0, 1로 이루어진 이진 상태를 가지므로 바이너리 세마포어(Binary Semaphore)라고 할 수 있습니다.

뮤텍스는 소유하고 있는 스레드만이 해당 뮤텍스를 해제할 수 있습니다. 반면, 세마포어는 해당 세마포어를 소유하지 않는 스레드가 세마포어를 해제할 수 있습니다.